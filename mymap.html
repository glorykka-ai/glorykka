<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë•ì†Œìš´ë™ (ì¹´ì¹´ì˜¤ë§µ)</title>
    <!-- Tailwind CSS CDN ë¡œë“œ --><script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 'Inter' í°íŠ¸ ì‚¬ìš© */
        body { font-family: 'Inter', sans-serif; }
        /* ì§€ë„ê°€ í‘œì‹œë  ì˜ì—­ ìŠ¤íƒ€ì¼ */
        #map {
            height: 100%;
            width: 100%;
            min-height: 500px;
        }
        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ (ëª¨ë°”ì¼ ë°˜ì‘í˜•) */
        .main-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        @media (min-width: 768px) {
            .main-container {
                flex-direction: row;
            }
        }
        /* ì»¤ìŠ¤í…€ ë§ˆì»¤ë¥¼ ìœ„í•œ CSS */
        .custom-marker-wrap {
            position: relative;
            width: 36px;
            height: 36px;
            text-align: center;
        }
        .custom-marker-icon {
            width: 32px;
            height: 32px;
            line-height: 32px;
            font-size: 16px;
            font-weight: bold;
            color: white;
            background-color: #f7d358; /* ì¹´ì¹´ì˜¤ ë…¸ë€ìƒ‰ ê³„ì—´ */
            border-radius: 50%;
            border: 2px solid #e0b83e;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            position: absolute;
            bottom: 0px; /* ë§ˆì»¤ ë°”ë‹¥ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ */
            left: 50%;
            transform: translateX(-50%);
        }
        .custom-marker-tip {
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 8px solid #f7d358;
            position: absolute;
            bottom: -8px; /* ì•„ì´ì½˜ ì•„ë˜ì— ì‚¼ê°í˜• ìœ„ì¹˜ */
            left: 50%;
            transform: translateX(-50%);
        }
    </style>

    <!-- ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œ -->
    <!-- YOUR_KAKAO_APP_KEYë¥¼ ë³¸ì¸ì˜ í‚¤ë¡œ êµì²´í•˜ì„¸ìš”. (í˜„ì¬ëŠ” ì˜ˆì‹œ í‚¤) -->
    <script type="text/javascript" 
            src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f1512adf04202ce72dd82ff7c0b857fd&libraries=services"></script>
</head>
<body class="bg-gray-50">

    <div class="main-container">
        <!-- ì¥ì†Œ ëª©ë¡ íŒ¨ë„ -->
        <div class="p-4 md:p-6 bg-white shadow-lg overflow-y-auto w-full md:w-1/3 max-h-screen">
            <h1 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">ğŸ“ ë•ì†Œì—­ ê·¼ì²˜ ì¥ì†Œ 10ì„  (ì¹´ì¹´ì˜¤ë§µ)</h1>
            <p class="text-sm text-gray-500 mb-4">ëª©ë¡ì„ í´ë¦­í•˜ê±°ë‚˜ ë§ˆì»¤ë¥¼ í´ë¦­í•˜ì—¬ ì§€ë„ì—ì„œ ìœ„ì¹˜ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
            
            <!-- ê¸¸ì°¾ê¸° ì‹œì‘ì  ì…ë ¥ ì„¹ì…˜ (ë³µì›) -->
            <div class="bg-blue-50 p-3 rounded-lg mb-4 shadow-inner">
                <label for="startLocation" class="block text-sm font-medium text-blue-700 mb-1">ì¶œë°œì§€ ì…ë ¥ (ê¸¸ì°¾ê¸° ì‹œì‘ì )</label>
                <input type="text" id="startLocation" placeholder="ì˜ˆ: ì„œìš¸ì—­ ë˜ëŠ” í˜„ì¬ ì£¼ì†Œ"
                       class="flex-grow p-2 w-full border border-blue-200 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-sm">
                <div id="directionStatus" class="mt-2 text-xs text-red-500 hidden"></div>
                <p class="text-xs text-yellow-700 mt-2">**ê° ì¥ì†Œ ëª©ë¡ ì˜†ì˜ 'ê¸¸ì°¾ê¸°' ë²„íŠ¼ì„ ëˆŒëŸ¬ ê²½ë¡œë¥¼ ê²€ìƒ‰í•˜ì„¸ìš”.**</p>
            </div>
            
            <!-- ì¥ì†Œ ëª©ë¡ -->
            <ul id="restaurantList" class="space-y-3">
                <!-- JavaScriptë¡œ ëª©ë¡ì´ ì±„ì›Œì§‘ë‹ˆë‹¤. -->
            </ul>
        </div>

        <!-- ì§€ë„ ì˜ì—­ -->
        <div id="map" class="w-full md:w-2/3"></div>
    </div>

    <script>
        // --- 1. ì¥ì†Œ ë°ì´í„° (ì—¬ê¸°ì„œ ìˆ˜ì •í•˜ì‹œë©´ ë©ë‹ˆë‹¤!) ---
        // { name: "ì¥ì†Œëª…", lat: ìœ„ë„, lng: ê²½ë„, description: "í•´ë‹¹ì£¼ì†Œ" } í˜•ì‹
        const restaurantsData = [
            { name: "í„±ê±¸ì´ì¥ì†Œ1", lat: 37.5872, lng: 127.2450, description: "ê²½ê¸°ë„ ë‚¨ì–‘ì£¼ì‹œ ì™€ë¶€ì ë•ì†Œë¦¬ 483-2" },
            { name: "íœ´ì‹ê³µì›2", lat: 37.5830, lng: 127.2385, description: "ë‚¨ì–‘ì£¼ì‹œ ì™€ë¶€ì ìˆ˜ë ˆë„˜ì–´ê¸¸ 12" },
            { name: "ìŠ¤í„°ë””ì¹´í˜3", lat: 37.5860, lng: 127.2415, description: "ë•ì†Œë¡œ 200ë²ˆê¸¸ 33" },
            { name: "ì•„íŒŒíŠ¸ë‹¨ì§€4", lat: 37.5845, lng: 127.2430, description: "ë•ì†Œë¡œ 108" },
            { name: "ìì „ê±°ë„ë¡œì‰¼í„°5", lat: 37.5890, lng: 127.2500, description: "íŒ”ë‹¹ë¡œ 801" },
            { name: "ë•ì†Œì²´ìœ¡ê³µì›6", lat: 37.5810, lng: 127.2350, description: "ë•ì†Œë¦¬ 110-1" },
            { name: "ë„ì„œê´€7", lat: 37.5900, lng: 127.2480, description: "ì™€ë¶€ì ë„ê³¡ë¦¬ 980" },
            { name: "í¸ì˜ì 8", lat: 37.5855, lng: 127.2405, description: "ë•ì†Œë¦¬ 450-12" },
            { name: "í”¼íŠ¸ë‹ˆìŠ¤ì„¼í„°9", lat: 37.5880, lng: 127.2465, description: "ë•ì†Œë¡œ 280ë²ˆê¸¸ 5" },
            { name: "ì€í–‰10", lat: 37.5835, lng: 127.2420, description: "ë•ì†Œë¡œ 155" }
        ];

        // --- 2. Kakao Maps API ê´€ë ¨ ë³€ìˆ˜ ---
        let map;
        let markers = [];
        let currentInfoWindow = null; // í˜„ì¬ ì—´ë¦° InfoWindow ì¸ìŠ¤í„´ìŠ¤

        // ë•ì†Œì—­ ì£¼ë³€ ì¤‘ì‹¬ ì¢Œí‘œ
        const DEOKSO_CENTER = { lat: 37.585, lng: 127.240 };
        
        // ìš”ì†Œ ì„ íƒ
        const restaurantListEl = document.getElementById('restaurantList');


        // --- 3. ì§€ë„ ì´ˆê¸°í™” í•¨ìˆ˜ ---
        function initMap() {
            if (typeof kakao === 'undefined' || !kakao.maps) {
                const mapEl = document.getElementById('map');
                mapEl.innerHTML = '<div class="p-4 text-red-600 bg-red-100 rounded-lg text-center font-semibold">ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. App Keyê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</div>';
                mapEl.style.height = '300px';
                return;
            }

            const mapContainer = document.getElementById('map');
            const mapOption = { 
                center: new kakao.maps.LatLng(DEOKSO_CENTER.lat, DEOKSO_CENTER.lng),
                level: 4
            };
            
            map = new kakao.maps.Map(mapContainer, mapOption); 
            map.setZoomable(true);

            renderRestaurants(restaurantsData);
            renderList(restaurantsData);
        }

        // --- 4. ë§ˆì»¤ ìƒì„± í•¨ìˆ˜ (HTML ì»¤ìŠ¤í…€ ë§ˆì»¤) ---
        function renderRestaurants(data) {
            // ê¸°ì¡´ ë§ˆì»¤ ì œê±°
            markers.forEach(marker => { marker.overlay.setMap(null); });
            markers = [];

            data.forEach((restaurant, index) => {
                const position = new kakao.maps.LatLng(restaurant.lat, restaurant.lng);
                
                // InfoWindow ì½˜í…ì¸  ìƒì„± (ê°„ë‹¨íˆ ì¥ì†Œëª…ê³¼ ì£¼ì†Œë§Œ í‘œì‹œ)
                const infoWindowContent = `
                    <div class="bg-white p-3 rounded-lg shadow-xl border border-gray-200" style="min-width: 150px;">
                        <h2 class="font-bold text-base text-gray-800 flex items-center mb-1">
                            <span class="text-xl inline-block mr-2 w-6 h-6 leading-6 text-center text-white bg-yellow-500 rounded-full">${index + 1}</span> 
                            <span class="ml-1">${restaurant.name}</span>
                        </h2>
                        <p class="text-xs text-gray-500">${restaurant.description}</p>
                    </div>
                `;

                const infoWindow = new kakao.maps.InfoWindow({
                    content: infoWindowContent,
                    removable: true
                });

                // ì»¤ìŠ¤í…€ ì˜¤ë²„ë ˆì´ë¡œ HTML ë§ˆì»¤ ìƒì„±
                const customOverlayContent = `
                    <div class="custom-marker-wrap">
                        <div class="custom-marker-icon">${index + 1}</div>
                        <div class="custom-marker-tip"></div>
                    </div>
                `;
                
                const customOverlay = new kakao.maps.CustomOverlay({
                    map: map,
                    position: position,
                    content: customOverlayContent,
                    yAnchor: 1.15
                });

                // ë§ˆì»¤ í´ë¦­ ì´ë²¤íŠ¸: InfoWindow í‘œì‹œ
                const markerElement = customOverlay.a.children[0];
                markerElement.addEventListener('click', () => {
                    openInfoWindow(index, position, infoWindow);
                });

                markers.push({ overlay: customOverlay, infoWindow: infoWindow });
            });
        }
        
        // --- 5. ëª©ë¡ ë Œë”ë§ í•¨ìˆ˜ (ê¸¸ì°¾ê¸° ë²„íŠ¼ ì¶”ê°€) ---
        function renderList(data) {
            restaurantListEl.innerHTML = '';
            data.forEach((restaurant, index) => {
                const li = document.createElement('li');
                li.id = `restaurant-${index}`;
                // ëª©ë¡ ì•„ì´í…œì„ ì„¸ë¡œ(ëª¨ë°”ì¼) ë˜ëŠ” ê°€ë¡œ(ë°ìŠ¤í¬íƒ‘)ë¡œ ì •ë ¬í•˜ê³  ë²„íŠ¼ì„ ë°°ì¹˜í•˜ê¸° ìœ„í•œ Tailwind í´ë˜ìŠ¤
                li.className = "p-3 bg-white border border-gray-200 rounded-xl hover:bg-yellow-50 cursor-pointer transition duration-150 shadow-sm flex flex-col space-y-2 md:flex-row md:space-y-0 md:justify-between md:items-center";
                
                li.innerHTML = `
                    <div class="flex items-start space-x-3 w-full md:w-auto">
                        <span class="inline-block w-6 h-6 leading-6 text-center text-white bg-yellow-500 rounded-full text-sm font-semibold">${index + 1}</span>
                        <div class="flex-grow info-content">
                            <div class="font-semibold text-gray-800">${restaurant.name}</div>
                            <div class="text-xs text-gray-500">${restaurant.description}</div>
                        </div>
                    </div>
                    <button data-index="${index}"
                            class="route-button mt-2 md:mt-0 bg-blue-500 hover:bg-blue-600 text-white font-semibold py-1.5 px-3 rounded-lg transition duration-150 text-xs shadow-md w-full md:w-auto">
                        ê¸¸ì°¾ê¸°
                    </button>
                `;
                
                // ì •ë³´ ë¶€ë¶„ í´ë¦­ ì‹œ íŒì—… ì—´ê¸° (ì´ì „ ë¡œì§ ìœ ì§€)
                li.querySelector('.info-content').addEventListener('click', (e) => {
                    const markerData = markers[index];
                    const position = markerData.overlay.getPosition();
                    openInfoWindow(index, position, markerData.infoWindow);
                });

                // ê¸¸ì°¾ê¸° ë²„íŠ¼ ë¡œì§
                li.querySelector('.route-button').addEventListener('click', (e) => {
                    e.stopPropagation(); // ëª©ë¡ í´ë¦­ ì´ë²¤íŠ¸ ì „íŒŒ ë°©ì§€
                    openRoutePage(index);
                });
                
                restaurantListEl.appendChild(li);
            });
        }

        // --- 6. InfoWindow ì—´ê¸° ë° UI ì—…ë°ì´íŠ¸ ê³µí†µ ë¡œì§ ---
        function openInfoWindow(index, position, infoWindow) {
             // ê¸°ì¡´ InfoWindow ë‹«ê¸°
            if (currentInfoWindow) {
                currentInfoWindow.close();
            }

            // í´ë¦­í•œ InfoWindowê°€ ì´ë¯¸ ì—´ë ¤ìˆë‹¤ë©´ ë‹«ê³ , ì•„ë‹ˆë©´ ì—´ê¸°
            if (currentInfoWindow === infoWindow && infoWindow.getMap()) {
                infoWindow.close();
                currentInfoWindow = null;
            } else {
                infoWindow.open(map, position);
                currentInfoWindow = infoWindow;
            }
            
            map.panTo(position); // ë§µ ì´ë™
            highlightListItem(index); // ëª©ë¡ í•˜ì´ë¼ì´íŠ¸
        }
        
        // --- 7. ëª©ë¡ í•­ëª© í•˜ì´ë¼ì´íŠ¸ í•¨ìˆ˜ ---
        function highlightListItem(selectedIndex) {
            document.querySelectorAll('#restaurantList li').forEach((li) => {
                li.classList.remove('bg-yellow-100', 'border-yellow-500');
                li.classList.add('bg-white', 'border-gray-200');
            });

            const selectedLi = document.getElementById(`restaurant-${selectedIndex}`);
            if (selectedLi) {
                selectedLi.classList.remove('bg-white', 'border-gray-200');
                selectedLi.classList.add('bg-yellow-100', 'border-yellow-500');
            }
        }
        
        // --- 8. ê²½ë¡œ ê²€ìƒ‰ í•¨ìˆ˜ (ê¸¸ì°¾ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰) ---
        function openRoutePage(index) {
            const destination = restaurantsData[index];
            const start = document.getElementById('startLocation').value.trim();
            const directionStatus = document.getElementById('directionStatus');

            // ì¶œë°œì§€ ìœ íš¨ì„± ê²€ì‚¬
            if (!start) {
                directionStatus.textContent = 'ì¶œë°œì§€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                directionStatus.classList.remove('hidden');
                document.getElementById('startLocation').focus(); 
                return;
            }
            directionStatus.classList.add('hidden'); // ì—ëŸ¬ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°

            // ì¹´ì¹´ì˜¤ë§µ ê¸¸ì°¾ê¸° URL ìƒì„±
            // sName: ì¶œë°œì§€ëª…, eName: ë„ì°©ì§€ëª…, eLat: ë„ì°©ì§€ ìœ„ë„, eLng: ë„ì°©ì§€ ê²½ë„
            const kakaoRouteUrl = `https://map.kakao.com/?sName=${encodeURIComponent(start)}&eName=${encodeURIComponent(destination.name)}&eLat=${destination.lat}&eLng=${destination.lng}`;

            // ìƒˆ íƒ­/ì°½ì—ì„œ ì¹´ì¹´ì˜¤ë§µ ê¸¸ì°¾ê¸° ì—´ê¸°
            window.open(kakaoRouteUrl, '_blank');
        }


        // --- ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œ í›„ ì´ˆê¸°í™” ---
        document.addEventListener('DOMContentLoaded', () => {
             if (window.kakao && kakao.maps) {
                initMap();
             } else {
                 const mapEl = document.getElementById('map');
                 mapEl.innerHTML = '<div class="p-4 text-red-600 bg-red-100 rounded-lg text-center font-semibold">ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. App Keyê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</div>';
                 mapEl.style.height = '300px';
             }
        });

    </script>

</body>
</html>
