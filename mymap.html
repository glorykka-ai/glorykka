<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë•ì†Œì—­ ë§›ì§‘ ì§€ë„ (ì¹´ì¹´ì˜¤ë§µ)</title>
    <!-- Tailwind CSS CDN ë¡œë“œ --><script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 'Inter' í°íŠ¸ ì‚¬ìš© */
        body { font-family: 'Inter', sans-serif; }
        /* ì§€ë„ê°€ í‘œì‹œë  ì˜ì—­ ìŠ¤íƒ€ì¼ */
        #map {
            height: 100%;
            width: 100%;
            min-height: 500px;
        }
        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ (ëª¨ë°”ì¼ ë°˜ì‘í˜•) */
        .main-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        @media (min-width: 768px) {
            .main-container {
                flex-direction: row;
            }
        }
        /* ê²½ë¡œ ì•ˆë‚´ íŒ¨ë„ì€ ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ìˆ¨ê¹€ */
        #directionsPanel { display: none !important; }

        /* ì»¤ìŠ¤í…€ ë§ˆì»¤ë¥¼ ìœ„í•œ CSS */
        .custom-marker-wrap {
            position: relative;
            width: 36px;
            height: 36px;
            text-align: center;
        }
        .custom-marker-icon {
            width: 32px;
            height: 32px;
            line-height: 32px;
            font-size: 16px;
            font-weight: bold;
            color: white;
            background-color: #f7d358; /* ì¹´ì¹´ì˜¤ ë…¸ë€ìƒ‰ ê³„ì—´ */
            border-radius: 50%;
            border: 2px solid #e0b83e;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            position: absolute;
            bottom: 0px; /* ë§ˆì»¤ ë°”ë‹¥ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ */
            left: 50%;
            transform: translateX(-50%);
        }
        .custom-marker-tip {
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 8px solid #f7d358;
            position: absolute;
            bottom: -8px; /* ì•„ì´ì½˜ ì•„ë˜ì— ì‚¼ê°í˜• ìœ„ì¹˜ */
            left: 50%;
            transform: translateX(-50%);
        }
    </style>

    <!-- ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œ --><!-- !! YOUR_KAKAO_APP_KEY ëŒ€ì‹  ë°œê¸‰ë°›ì€ App Keyë¥¼ ì…ë ¥í•˜ì„¸ìš”. !! --><script type="text/javascript" 
            src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f1512adf04202ce72dd82ff7c0b857fd&libraries=services"></script>
</head>
<body class="bg-gray-50">

    <div class="main-container">
        <!-- ë§›ì§‘ ëª©ë¡ ë° ê¸¸ì°¾ê¸° ì»¨íŠ¸ë¡¤ íŒ¨ë„ --><div class="p-4 md:p-6 bg-white shadow-lg overflow-y-auto w-full md:w-1/3 max-h-screen">
            <h1 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">ğŸ“ ë•ì†Œì—­ ê·¼ì²˜ ë§›ì§‘ 10ì„  (ì¹´ì¹´ì˜¤ë§µ)</h1>
            <p class="text-sm text-gray-500 mb-4">ëª©ë¡ì„ í´ë¦­í•˜ê±°ë‚˜ ë§ˆì»¤ë¥¼ í´ë¦­í•˜ì—¬ ì§€ë„ì— í‘œì‹œí•˜ê³  ê¸¸ì°¾ê¸° ëª©ì ì§€ë¡œ ì„ íƒí•˜ì„¸ìš”.</p>

            <!-- ê¸¸ì°¾ê¸° ì…ë ¥ ì„¹ì…˜ --><div class="bg-blue-50 p-3 rounded-lg mb-4 shadow-inner">
                <label for="startLocation" class="block text-sm font-medium text-blue-700 mb-1">ì¶œë°œì§€ ì…ë ¥ (ê¸¸ì°¾ê¸°)</label>
                <div class="flex space-x-2">
                    <input type="text" id="startLocation" placeholder="ì˜ˆ: ì„œìš¸ì—­ ë˜ëŠ” ì£¼ì†Œ"
                           class="flex-grow p-2 border border-blue-200 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-sm">
                    <button id="searchDirectionBtn" disabled
                            class="bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-150 disabled:bg-gray-300 disabled:cursor-not-allowed text-sm shadow-md">
                        ê²½ë¡œ ê²€ìƒ‰
                    </button>
                </div>
                <div id="directionStatus" class="mt-2 text-xs text-red-500 hidden"></div>
                <p class="text-xs text-yellow-700 mt-2">**ê²½ë¡œ ê²€ìƒ‰ ì‹œ ì¹´ì¹´ì˜¤ë§µ ê¸¸ì°¾ê¸° í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.**</p>
            </div>

            <!-- ë§›ì§‘ ëª©ë¡ --><ul id="restaurantList" class="space-y-3">
                <!-- JavaScriptë¡œ ëª©ë¡ì´ ì±„ì›Œì§‘ë‹ˆë‹¤. --></ul>

            <!-- ê²½ë¡œ í‘œì‹œ ì˜ì—­ (ì‚¬ìš© ì•ˆ í•¨) --><div id="directionsPanel" class="mt-4 p-3 bg-gray-100 rounded-lg">
                <h3 class="text-lg font-semibold text-gray-700 mb-2">ê²½ë¡œ ì•ˆë‚´ (ìƒˆ íƒ­ì—ì„œ í™•ì¸)</h3>
            </div>
        </div>

        <!-- ì§€ë„ ì˜ì—­ --><div id="map" class="w-full md:w-2/3"></div>
    </div>

    <script>
        // --- 1. ë§›ì§‘ ë°ì´í„° (ì—¬ê¸°ì„œ ìˆ˜ì •í•˜ì‹œë©´ ë©ë‹ˆë‹¤!) ---
        // ë§›ì§‘ëª…, ìœ„ë„(lat), ê²½ë„(lng), ê°„ë‹¨ ì„¤ëª… (description)ì„ ìˆ˜ì •í•˜ì„¸ìš”.
        // icon ì†ì„±ì€ ë” ì´ìƒ ì´ëª¨ì§€ê°€ ì•„ë‹Œ ìˆœì„œ ë²ˆí˜¸ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.
        const restaurantsData = [
            { name: "ë•ì†Œ ë–¡ê°ˆë¹„ì§‘", lat: 37.5872, lng: 127.2450, description: "ì „í†µ ë–¡ê°ˆë¹„ ì „ë¬¸ì " },
            { name: "ë‚˜ë£¨í„° ë¯¼ë¬¼ë§¤ìš´íƒ•", lat: 37.5830, lng: 127.2385, description: "ì–¼í°í•œ ë¯¼ë¬¼ë§¤ìš´íƒ•" },
            { name: "ì˜›ë‚  ì§œì¥ë©´", lat: 37.5860, lng: 127.2415, description: "ì¶”ì–µì˜ ì†ì§œì¥" },
            { name: "í“¨ì „ íŒŒìŠ¤íƒ€", lat: 37.5845, lng: 127.2430, description: "ì‹ ì„ í•œ ì¬ë£Œì˜ íŒŒìŠ¤íƒ€" },
            { name: "ë•ì†Œ í•œìš°ë§ˆì„", lat: 37.5890, lng: 127.2500, description: "ìµœìƒê¸‰ í•œìš° êµ¬ì´" },
            { name: "ê°•ë³€ íšŒìˆ˜ì‚°", lat: 37.5810, lng: 127.2350, description: "ì‹±ì‹±í•œ í™œì–´íšŒ" },
            { name: "ì‚°ê³¨ ë³´ë¦¬ë°¥", lat: 37.5900, lng: 127.2480, description: "ê±´ê°•í•œ ì‚°ì±„ ë³´ë¦¬ë°¥" },
            { name: "ëª¨ë˜ ë¸ŒëŸ°ì¹˜ ì¹´í˜", lat: 37.5855, lng: 127.2405, description: "ì¸ìŠ¤íƒ€ ê°ì„± ë¸ŒëŸ°ì¹˜" },
            { name: "ë§¤ì½¤ ë‹­ë³¶ìŒíƒ•", lat: 37.5880, lng: 127.2465, description: "ìŠ¤íŠ¸ë ˆìŠ¤ í•´ì†Œ ë‹­ë³¶ìŒíƒ•" },
            { name: "ìˆ˜ì œë²„ê±° ì „ë¬¸ì ", lat: 37.5835, lng: 127.2420, description: "íŒ¨í‹°ê°€ ì¼í’ˆì¸ ë²„ê±°" }
        ];

        // --- 2. Kakao Maps API ê´€ë ¨ ë³€ìˆ˜ ---
        let map;
        let markers = [];
        let currentInfoWindow = null; // í˜„ì¬ ì—´ë¦° InfoWindow ì¸ìŠ¤í„´ìŠ¤
        let selectedDestination = null; // í˜„ì¬ ì„ íƒëœ ë§›ì§‘ (ê²½ë¡œ ëª©ì ì§€)

        // ë•ì†Œì—­ ì£¼ë³€ ì¤‘ì‹¬ ì¢Œí‘œ
        const DEOKSO_CENTER = { lat: 37.585, lng: 127.240 };
        
        // ìš”ì†Œ ì„ íƒ
        const restaurantListEl = document.getElementById('restaurantList');
        const searchDirectionBtn = document.getElementById('searchDirectionBtn');
        const startLocationInput = document.getElementById('startLocation');
        const directionStatus = document.getElementById('directionStatus');


        // --- 3. ì§€ë„ ì´ˆê¸°í™” í•¨ìˆ˜ ---
        function initMap() {
            if (typeof kakao === 'undefined' || !kakao.maps) {
                const mapEl = document.getElementById('map');
                mapEl.innerHTML = '<div class="p-4 text-red-600 bg-red-100 rounded-lg text-center font-semibold">ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. App Keyê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</div>';
                mapEl.style.height = '300px';
                return;
            }

            const mapContainer = document.getElementById('map');
            const mapOption = { 
                center: new kakao.maps.LatLng(DEOKSO_CENTER.lat, DEOKSO_CENTER.lng),
                level: 4
            };
            
            map = new kakao.maps.Map(mapContainer, mapOption); 
            map.setZoomable(true);

            renderRestaurants(restaurantsData);
            renderList(restaurantsData);
        }

        // --- 4. ë§ˆì»¤ ìƒì„± í•¨ìˆ˜ (Kakao Map ë²„ì „, HTML ì»¤ìŠ¤í…€ ë§ˆì»¤) ---
        function renderRestaurants(data) {
            markers.forEach(marker => { marker.setMap(null); });
            markers = [];

            data.forEach((restaurant, index) => {
                const position = new kakao.maps.LatLng(restaurant.lat, restaurant.lng);
                
                // InfoWindow ì½˜í…ì¸  ìƒì„±
                const infoWindowContent = `
                    <div class="bg-white p-3 rounded-lg shadow-xl border border-gray-200" style="min-width: 150px;">
                        <h2 class="font-bold text-base text-gray-800 flex items-center mb-1">
                            <span class="text-xl inline-block mr-2 w-6 h-6 leading-6 text-center text-white bg-yellow-500 rounded-full">${index + 1}</span> 
                            <span class="ml-1">${restaurant.name}</span>
                        </h2>
                        <p class="text-xs text-gray-500 mb-2">${restaurant.description}</p>
                        <button onclick="window.selectDestination(${index})" 
                            class="w-full text-xs bg-yellow-500 hover:bg-yellow-600 text-white py-1.5 rounded transition shadow-sm">
                            ê¸¸ì°¾ê¸° ëª©ì ì§€ë¡œ ì„ íƒ
                        </button>
                    </div>
                `;

                const infoWindow = new kakao.maps.InfoWindow({
                    content: infoWindowContent,
                    removable: true
                });

                // ì»¤ìŠ¤í…€ ì˜¤ë²„ë ˆì´ë¡œ HTML ë§ˆì»¤ ìƒì„±
                const customOverlayContent = `
                    <div class="custom-marker-wrap">
                        <div class="custom-marker-icon">${index + 1}</div>
                        <div class="custom-marker-tip"></div>
                    </div>
                `;
                
                const customOverlay = new kakao.maps.CustomOverlay({
                    map: map,
                    position: position,
                    content: customOverlayContent,
                    yAnchor: 1.15 // ë§ˆì»¤ì˜ ì•„ë˜ìª½ ëì„ ì¢Œí‘œì— ë§ì¶¤
                });

                // ì»¤ìŠ¤í…€ ì˜¤ë²„ë ˆì´ëŠ” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì§ì ‘ ë¶™ì¼ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ,
                // HTML ìš”ì†Œë¥¼ ì§ì ‘ ì„ íƒí•˜ì—¬ ì´ë²¤íŠ¸ë¥¼ ë¶€ì—¬
                const markerElement = customOverlay.a.children[0]; // CustomOverlay ë‚´ë¶€ DOM ìš”ì†Œ ì ‘ê·¼
                markerElement.addEventListener('click', () => {
                    if (currentInfoWindow) {
                        currentInfoWindow.close();
                    }

                    if (currentInfoWindow === infoWindow && infoWindow.getMap()) {
                        infoWindow.close();
                        currentInfoWindow = null;
                    } else {
                        infoWindow.open(map, position); // InfoWindowë¥¼ ì»¤ìŠ¤í…€ ì˜¤ë²„ë ˆì´ì˜ ìœ„ì¹˜ì— ë„ì›€
                        currentInfoWindow = infoWindow;
                    }

                    highlightListItem(index);
                    map.panTo(position);
                });

                // ë§ˆì»¤ ë°°ì—´ì— CustomOverlayì™€ InfoWindowë¥¼ í•¨ê»˜ ì €ì¥ (í•„ìš” ì‹œ í™œìš©)
                markers.push({ overlay: customOverlay, infoWindow: infoWindow });
            });
        }

        // --- 5. ëª©ë¡ ë Œë”ë§ í•¨ìˆ˜ (HTML ì•„ì´ì½˜ìœ¼ë¡œ ë³€ê²½) ---
        function renderList(data) {
            restaurantListEl.innerHTML = '';
            data.forEach((restaurant, index) => {
                const li = document.createElement('li');
                li.id = `restaurant-${index}`;
                li.className = "p-3 bg-white border border-gray-200 rounded-xl hover:bg-yellow-50 cursor-pointer transition duration-150 shadow-sm flex items-center space-x-3";
                li.innerHTML = `
                    <span class="inline-block w-6 h-6 leading-6 text-center text-white bg-yellow-500 rounded-full text-sm font-semibold">${index + 1}</span>
                    <div>
                        <div class="font-semibold text-gray-800">${restaurant.name}</div>
                        <div class="text-xs text-gray-500">${restaurant.description}</div>
                    </div>
                `;
                li.addEventListener('click', () => {
                    // ë§ˆì»¤ í´ë¦­ ì´ë²¤íŠ¸ì™€ ë™ì¼í•œ ë™ì‘ ìˆ˜í–‰
                    const markerData = markers[index];
                    const position = markerData.overlay.getPosition(); // CustomOverlayì˜ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°

                    if (currentInfoWindow) {
                        currentInfoWindow.close();
                    }
                    if (currentInfoWindow === markerData.infoWindow && markerData.infoWindow.getMap()) {
                        markerData.infoWindow.close();
                        currentInfoWindow = null;
                    } else {
                        markerData.infoWindow.open(map, position);
                        currentInfoWindow = markerData.infoWindow;
                    }
                    
                    selectDestination(index); // ëª©ì ì§€ ì„ íƒ
                    map.panTo(position); // ë§µ ì´ë™
                });
                restaurantListEl.appendChild(li);
            });
        }

        // --- 6. ëª©ì ì§€ ì„ íƒ ë° UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ ---
        window.selectDestination = function(index) {
            selectedDestination = restaurantsData[index];
            const name = selectedDestination.name;

            searchDirectionBtn.textContent = `${name} (ìœ¼)ë¡œ ê¸¸ì°¾ê¸°`;
            searchDirectionBtn.disabled = false;
            
            map.panTo(new kakao.maps.LatLng(selectedDestination.lat, selectedDestination.lng));

            highlightListItem(index);
        }
        
        // --- 7. ëª©ë¡ í•­ëª© í•˜ì´ë¼ì´íŠ¸ í•¨ìˆ˜ ---
        function highlightListItem(selectedIndex) {
            document.querySelectorAll('#restaurantList li').forEach((li) => {
                li.classList.remove('bg-yellow-100', 'border-yellow-500');
                li.classList.add('bg-white', 'border-gray-200');
            });

            const selectedLi = document.getElementById(`restaurant-${selectedIndex}`);
            if (selectedLi) {
                selectedLi.classList.remove('bg-white', 'border-gray-200');
                selectedLi.classList.add('bg-yellow-100', 'border-yellow-500');
            }
        }

        // --- 8. ê²½ë¡œ ê²€ìƒ‰ í•¨ìˆ˜ (ì¹´ì¹´ì˜¤ë§µ ì›¹í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰ì…˜) ---
        function calculateAndDisplayRoute() {
            if (!selectedDestination) {
                directionStatus.textContent = 'ë¨¼ì € ëª©ë¡ì—ì„œ ëª©ì ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.';
                directionStatus.classList.remove('hidden');
                return;
            }

            const start = startLocationInput.value.trim();
            if (!start) {
                directionStatus.textContent = 'ì¶œë°œì§€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                directionStatus.classList.remove('hidden');
                return;
            }
            directionStatus.classList.add('hidden');

            const kakaoRouteUrl = `https://map.kakao.com/?sName=${encodeURIComponent(start)}&eName=${encodeURIComponent(selectedDestination.name)}&eLat=${selectedDestination.lat}&eLng=${selectedDestination.lng}`;

            window.open(kakaoRouteUrl, '_blank');
        }

        // --- 9. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
        searchDirectionBtn.addEventListener('click', calculateAndDisplayRoute);

        startLocationInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !searchDirectionBtn.disabled) {
                calculateAndDisplayRoute();
            }
        });


        // --- ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œ í›„ ì´ˆê¸°í™” ---
        document.addEventListener('DOMContentLoaded', () => {
             if (window.kakao && kakao.maps) {
                initMap();
             } else {
                 const mapScript = document.querySelector('script[src*="dapi.kakao.com"]');
                 mapScript.onload = initMap;
                 mapScript.onerror = () => {
                     const mapEl = document.getElementById('map');
                     mapEl.innerHTML = '<div class="p-4 text-red-600 bg-red-100 rounded-lg text-center font-semibold">ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. App Keyê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</div>';
                     mapEl.style.height = '300px';
                 };
             }
        });

    </script>

</body>
</html>
