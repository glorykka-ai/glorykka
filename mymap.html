<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë•ì†Œ ìš´ë™ ë§µ</title>
    <!-- Tailwind CSS CDN ë¡œë“œ --><script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 'Inter' í°íŠ¸ ì‚¬ìš© */
        body { font-family: 'Inter', sans-serif; }
        /* ì§€ë„ê°€ í‘œì‹œë  ì˜ì—­ ìŠ¤íƒ€ì¼ */
        #map {
            height: 100%;
            width: 100%;
            min-height: 500px;
        }
        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ (ëª¨ë°”ì¼ ë°˜ì‘í˜•) */
        .main-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        @media (min-width: 768px) {
            .main-container {
                flex-direction: row;
            }
        }
        /* ì»¤ìŠ¤í…€ ë§ˆì»¤ë¥¼ ìœ„í•œ CSS */
        .custom-marker-wrap {
            position: relative;
            width: 36px;
            height: 36px;
            text-align: center;
        }
        .custom-marker-icon {
            width: 32px;
            height: 32px;
            line-height: 32px;
            font-size: 16px;
            font-weight: bold;
            color: white;
            /* ë¶‰ì€ìƒ‰ ê³„ì—´ */
            background-color: #dc3545; 
            border-radius: 50%;
            border: 2px solid #c82333; 
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            position: absolute;
            bottom: 0px; 
            left: 50%;
            transform: translateX(-50%);
        }
        .custom-marker-tip {
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            /* ë¶‰ì€ìƒ‰ ê³„ì—´ */
            border-top: 8px solid #dc3545; 
            position: absolute;
            bottom: -8px; 
            left: 50%;
            transform: translateX(-50%);
        }
        /* ë¦¬ìŠ¤íŠ¸ ì„ íƒ ì‹œ í•˜ì´ë¼ì´íŠ¸ ìƒ‰ìƒ */
        .bg-red-100 { background-color: #fcebeb; /* Light Red */ }
        .border-red-500 { border-color: #dc3545; /* Red */ }
        .hover\:bg-red-50:hover { background-color: #fdf5f5; /* Very Light Red */ }

        /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° (ëª¨ë°”ì¼ ê°€ë¡œ ìŠ¤í¬ë¡¤ ì‹œ) */
        .scrollbar-hide {
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }
    </style>

    <!-- ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œ -->
    <!-- YOUR_KAKAO_APP_KEYë¥¼ ë³¸ì¸ì˜ í‚¤ë¡œ êµì²´í•˜ì„¸ìš”. (í˜„ì¬ëŠ” ì˜ˆì‹œ í‚¤) -->
    <script type="text/javascript" 
            src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f1512adf04202ce72dd82ff7c0b857fd&libraries=services"></script>
</head>
<body class="bg-gray-50">

    <div class="main-container">
        <!-- ì¥ì†Œ ëª©ë¡ íŒ¨ë„ -->
        <!-- PC: w-1/3, h-full, overflow-y-auto (ì„¸ë¡œ ìŠ¤í¬ë¡¤) -->
        <!-- ëª¨ë°”ì¼: h-auto (ë‚´ìš©ë¬¼ ë†’ì´ì— ë§ì¶¤) -->
        <div class="p-4 md:p-6 bg-white shadow-lg w-full md:w-1/3 h-auto md:h-full md:overflow-y-auto">
            <h1 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">ğŸ“ ë•ì†Œ ìš´ë™ ë§µ</h1>
            <p class="text-sm text-gray-500 mb-4">ëª©ë¡ì„ í´ë¦­í•˜ê±°ë‚˜ ë§ˆì»¤ë¥¼ í´ë¦­í•˜ì—¬ ì§€ë„ì—ì„œ ìœ„ì¹˜ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
            
            <!-- ê¸¸ì°¾ê¸° ì•ˆë‚´ (ê³ ì •) -->
            <div class="bg-blue-50 p-3 rounded-lg mb-4 shadow-inner">
                <p class="text-sm font-medium text-blue-700">ë°”ë¡œ ê¸¸ì°¾ê¸°</p>
                <p class="text-xs text-yellow-700 mt-1">**'ê¸¸ì°¾ê¸°' ë²„íŠ¼ í´ë¦­ ì‹œ í•´ë‹¹ ì¥ì†Œë¡œ ë°”ë¡œ ì´ë™í•˜ëŠ” ì¹´ì¹´ì˜¤ë§µ ê²½ë¡œê°€ ì—´ë¦½ë‹ˆë‹¤.**</p>
            </div>
            
            <!-- ì¥ì†Œ ëª©ë¡ ì»¨í…Œì´ë„ˆ -->
            <!-- ëª¨ë°”ì¼: ê°€ë¡œ ìŠ¤í¬ë¡¤ (overflow-x-auto, scrollbar-hide) -->
            <!-- PC: ì„¸ë¡œ ìŠ¤í¬ë¡¤ë¡œ ëŒ€ì²´ë˜ë¯€ë¡œ ê°€ë¡œ ìŠ¤í¬ë¡¤ ê´€ë ¨ í´ë˜ìŠ¤ ì œê±° (md:overflow-x-visible) -->
            <div class="overflow-x-auto scrollbar-hide md:overflow-x-visible">
                <!-- ëª¨ë°”ì¼: flex (ê°€ë¡œ ë°°ì—´), space-x-3 (ê°€ë¡œ ê°„ê²©) -->
                <!-- PC: md:flex-col (ì„¸ë¡œ ë°°ì—´), md:space-x-0 md:space-y-3 (ì„¸ë¡œ ê°„ê²©) -->
                <ul id="restaurantList" class="flex md:flex-col space-x-3 md:space-x-0 space-y-0 md:space-y-3 pb-3 pr-2">
                    <!-- JavaScriptë¡œ ëª©ë¡ì´ ì±„ì›Œì§‘ë‹ˆë‹¤. -->
                </ul>
            </div>
        </div>

        <!-- ì§€ë„ ì˜ì—­ -->
        <div id="map" class="w-full md:w-2/3 flex-grow"></div>
    </div>

    <script>
        // --- 1. ì¥ì†Œ ë°ì´í„° (ì—¬ê¸°ì„œ ìˆ˜ì •í•˜ì‹œë©´ ë©ë‹ˆë‹¤!) ---
        // { name: "ì¥ì†Œëª…", lat: ìœ„ë„, lng: ê²½ë„, description: "í•´ë‹¹ì£¼ì†Œ" } í˜•ì‹
        const restaurantsData = [
            // ë•ì†Œì—­ ì£¼ë³€ ì•„íŒŒíŠ¸ ë‹¨ì§€ ë° ì£¼ìš” ì¥ì†Œë¡œ ë°ì´í„° ìˆ˜ì •
            { name: "ë•ì†Œ ë‘ì‚°ìœ„ë¸Œ ì•„íŒŒíŠ¸", lat:37.580250, lng: 127.215721, description: "ê²½ê¸° ë‚¨ì–‘ì£¼ì‹œ ì™€ë¶€ì ë•ì†Œë¡œ 180" },
            { name: "ë•ì†Œì£¼ê³µ2ë‹¨ì§€ì•„íŒŒíŠ¸", lat: 37.585628, lng: 127.214399, description: "ê²½ê¸° ë‚¨ì–‘ì£¼ì‹œ ì™€ë¶€ì ë•ì†Œë¡œ97ë²ˆê¸¸ 12" },
            { name: "ë•ì†Œê°•ë³€í˜„ëŒ€í™ˆíƒ€ìš´ì•„íŒŒíŠ¸", lat: 37.585081, lng: 127.208714, description: "ê²½ê¸° ë‚¨ì–‘ì£¼ì‹œ ì™€ë¶€ì ë•ì†Œë¡œ116ë²ˆê¸¸ 49" }
        ];
        // --- 2. Kakao Maps API ê´€ë ¨ ë³€ìˆ˜ ---
        let map;
        let markers = [];
        let currentInfoWindow = null; 

        // ì§€ë„ ì´ˆê¸° ì¤‘ì•™ ì¢Œí‘œ 
        const DEOKSO_CENTER = { lat:37.580250, lng: 127.215721};
        
        // ìš”ì†Œ ì„ íƒ
        const restaurantListEl = document.getElementById('restaurantList');


        // --- 3. ì§€ë„ ì´ˆê¸°í™” í•¨ìˆ˜ ---
        function initMap() {
            if (typeof kakao === 'undefined' || !kakao.maps) {
                const mapEl = document.getElementById('map');
                mapEl.innerHTML = '<div class="p-4 text-red-600 bg-red-100 rounded-lg text-center font-semibold">ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. App Keyê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</div>';
                mapEl.style.height = '300px';
                return;
            }

            const mapContainer = document.getElementById('map');
            const mapOption = { 
                center: new kakao.maps.LatLng(DEOKSO_CENTER.lat, DEOKSO_CENTER.lng),
                level: 4
            };
            
            map = new kakao.maps.Map(mapContainer, mapOption); 
            map.setZoomable(true);

            renderRestaurants(restaurantsData);
            renderList(restaurantsData);
        }

        // --- 4. ë§ˆì»¤ ìƒì„± í•¨ìˆ˜ (HTML ì»¤ìŠ¤í…€ ë§ˆì»¤) ---
        function renderRestaurants(data) {
            // ê¸°ì¡´ ë§ˆì»¤ ì œê±°
            markers.forEach(marker => { 
                marker.overlay.setMap(null); 
                if (marker.infoWindow) {
                    marker.infoWindow.close();
                }
            });
            markers = [];

            data.forEach((restaurant, index) => {
                const position = new kakao.maps.LatLng(restaurant.lat, restaurant.lng);
                
                // InfoWindow ì½˜í…ì¸  ìƒì„± (ê°„ë‹¨íˆ ì¥ì†Œëª…ê³¼ ì£¼ì†Œë§Œ í‘œì‹œ)
                const infoWindowContent = `
                    <div class="bg-white p-3 rounded-lg shadow-xl border border-gray-200" style="min-width: 150px;">
                        <h2 class="font-bold text-base text-gray-800 flex items-center mb-1">
                            <span class="text-xl inline-block mr-2 w-6 h-6 leading-6 text-center text-white bg-red-600 rounded-full">${index + 1}</span> 
                            <span class="ml-1">${restaurant.name}</span>
                        </h2>
                        <p class="text-xs text-gray-500">${restaurant.description}</p>
                    </div>
                `;

                const infoWindow = new kakao.maps.InfoWindow({
                    content: infoWindowContent,
                    removable: true
                });

                // ì»¤ìŠ¤í…€ ì˜¤ë²„ë ˆì´ë¡œ HTML ë§ˆì»¤ ìƒì„±
                const customOverlayContent = `
                    <div class="custom-marker-wrap">
                        <div class="custom-marker-icon">${index + 1}</div>
                        <div class="custom-marker-tip"></div>
                    </div>
                `;
                
                const customOverlay = new kakao.maps.CustomOverlay({
                    map: map,
                    position: position,
                    content: customOverlayContent,
                    yAnchor: 1.15
                });

                // ë§ˆì»¤ í´ë¦­ ì´ë²¤íŠ¸: InfoWindow í‘œì‹œ
                const markerElement = customOverlay.a.children[0];
                markerElement.addEventListener('click', (e) => {
                    e.stopPropagation(); // ëª¨ë°”ì¼ í™˜ê²½ì—ì„œ ì¤‘ë³µ ì´ë²¤íŠ¸ ë°©ì§€
                    // panTo í•¨ìˆ˜ë¥¼ í†µí•´ ì§€ë„ ì´ë™ ë° InfoWindow í‘œì‹œ ì²˜ë¦¬
                    panTo(restaurant.lat, restaurant.lng, index);
                });

                markers.push({ overlay: customOverlay, infoWindow: infoWindow });
            });
        }
        
        // --- 5. ëª©ë¡ ë Œë”ë§ í•¨ìˆ˜ (ê¸¸ì°¾ê¸° ë²„íŠ¼ ì¶”ê°€) ---
        function renderList(data) {
            restaurantListEl.innerHTML = '';
            data.forEach((restaurant, index) => {
                const li = document.createElement('li');
                li.id = `restaurant-${index}`;
                
                // **ë°˜ì‘í˜• í´ë˜ìŠ¤ ì ìš©**: ëª¨ë°”ì¼ w-72 flex-shrink-0 (ê°€ë¡œ ì¹´ë“œ), PC md:w-auto md:flex-shrink (ì„¸ë¡œ ëª©ë¡)
                li.className = "p-3 bg-white border border-gray-200 rounded-xl hover:bg-red-50 cursor-pointer transition duration-150 shadow-sm flex flex-col space-y-2 md:flex-row md:space-y-0 md:justify-between md:items-center w-72 flex-shrink-0 md:w-auto md:flex-shrink";
                
                li.innerHTML = `
                    <div class="flex items-start space-x-3 w-full md:w-auto">
                        <!-- ë¶‰ì€ìƒ‰ ì•„ì´ì½˜ -->
                        <span class="inline-block w-6 h-6 leading-6 text-center text-white bg-red-600 rounded-full text-sm font-semibold">${index + 1}</span>
                        <!-- info-content í´ë¦­ ì‹œ ì§€ë„ ì´ë™ ë° íŒì—… í‘œì‹œ -->
                        <div class="flex-grow info-content" onclick="panTo(${restaurant.lat}, ${restaurant.lng}, ${index})">
                            <div class="font-semibold text-gray-800">${restaurant.name}</div>
                            <div class="text-xs text-gray-500">${restaurant.description}</div>
                        </div>
                    </div>
                    <!-- ê¸¸ì°¾ê¸° ë²„íŠ¼ -->
                    <button data-index="${index}"
                            class="route-button mt-2 md:mt-0 bg-blue-500 hover:bg-blue-600 text-white font-semibold py-1.5 px-3 rounded-lg transition duration-150 text-xs shadow-md w-full md:w-auto">
                        ê¸¸ì°¾ê¸°
                    </button>
                `;
                
                // ê¸¸ì°¾ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
                li.querySelector('.route-button').addEventListener('click', (e) => {
                    e.stopPropagation(); 
                    openRoutePage(index);
                });
                
                restaurantListEl.appendChild(li);
            });
        }
        
        // --- 6. ì „ì—­ í•¨ìˆ˜: ì§€ë„ ì´ë™ ë° InfoWindow í‘œì‹œ (ìµœëŒ€ ì•ˆì •ì„± í™•ë³´ ë¡œì§) ---
        window.panTo = function(lat, lng, index) {
            if (!map || typeof kakao === 'undefined' || !kakao.maps) return;

            const position = new kakao.maps.LatLng(lat, lng);
            const infoWindow = markers[index].infoWindow;
            
            // 1. ì§€ë„ ì¤‘ì‹¬ì„ ë¨¼ì € ì´ë™í•©ë‹ˆë‹¤. (map.setCenter ì‚¬ìš©ìœ¼ë¡œ ë³€ê²½)
            map.setCenter(position); 

            // 2. InfoWindowì™€ UI ì—…ë°ì´íŠ¸ ë¡œì§ì€ 300ms ë”œë ˆì´ë¥¼ ì£¼ì–´ ì•ˆì •ì„±ì„ í™•ë³´í•©ë‹ˆë‹¤.
            setTimeout(() => {
                // InfoWindow í‘œì‹œ ë¡œì§
                if (currentInfoWindow) {
                    currentInfoWindow.close();
                }

                // í˜„ì¬ í´ë¦­í•œ ë§ˆì»¤ì˜ InfoWindowê°€ ì´ë¯¸ ì—´ë ¤ìˆë‹¤ë©´ ë‹«ê³ , ì•„ë‹ˆë©´ ì—´ê¸°
                if (currentInfoWindow === infoWindow && infoWindow.getMap()) {
                    infoWindow.close();
                    currentInfoWindow = null;
                } else {
                    infoWindow.open(map, position);
                    currentInfoWindow = infoWindow;
                }
                
                highlightListItem(index); // ëª©ë¡ í•˜ì´ë¼ì´íŠ¸
                
                // ëª¨ë°”ì¼ ìŠ¤í¬ë¡¤ ë¡œì§
                if (window.innerWidth < 768) {
                    const selectedLi = document.getElementById(`restaurant-${index}`);
                    if (selectedLi) {
                        const container = document.querySelector('.overflow-x-auto');
                        // í•´ë‹¹ í•­ëª©ì´ ì¤‘ì•™ì— ì˜¤ë„ë¡ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ê³„ì‚°
                        const scrollX = selectedLi.offsetLeft - (container.offsetWidth / 2) + (selectedLi.offsetWidth / 2);
                        container.scrollTo({ left: scrollX, behavior: 'smooth' });
                    }
                }
            }, 300); // ì§€ì—° ì‹œê°„ì„ 300msë¡œ ëŠ˜ë¦¼
        }
        
        // --- 7. ëª©ë¡ í•­ëª© í•˜ì´ë¼ì´íŠ¸ í•¨ìˆ˜ ---
        function highlightListItem(selectedIndex) {
            document.querySelectorAll('#restaurantList li').forEach((li) => {
                li.classList.remove('bg-red-100', 'border-red-500'); 
                li.classList.add('bg-white', 'border-gray-200'); 
            });

            const selectedLi = document.getElementById(`restaurant-${selectedIndex}`);
            if (selectedLi) {
                selectedLi.classList.remove('bg-white', 'border-gray-200');
                selectedLi.classList.add('bg-red-100', 'border-red-500');
            }
        }
        
        // --- 8. ê²½ë¡œ ê²€ìƒ‰ í•¨ìˆ˜ (ê¸¸ì°¾ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰) ---
        function openRoutePage(index) {
            const destination = restaurantsData[index];
            
            // í˜•ì‹: https://map.kakao.com/link/to/ì¥ì†Œëª…,ìœ„ë„,ê²½ë„
            const kakaoRouteUrl = `https://map.kakao.com/link/to/${encodeURIComponent(destination.name)},${destination.lat},${destination.lng}`;

            window.open(kakaoRouteUrl, '_blank');
        }


        // --- ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œ í›„ ì´ˆê¸°í™” ---
        document.addEventListener('DOMContentLoaded', () => {
             if (window.kakao && kakao.maps) {
                initMap();
             } else {
                 const mapEl = document.getElementById('map');
                 mapEl.innerHTML = '<div class="p-4 text-red-600 bg-red-100 rounded-lg text-center font-semibold">ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. App Keyê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</div>';
                 mapEl.style.height = '300px';
             }
        });
        
        // ì§€ë„ í¬ê¸° ë³€ê²½ ì‹œ ì¤‘ì•™ ìœ ì§€
        window.addEventListener('resize', () => {
            if (map) {
                map.relayout();
                map.setCenter(new kakao.maps.LatLng(DEOKSO_CENTER.lat, DEOKSO_CENTER.lng));
            }
        });

    </script>

</body>
</html>

